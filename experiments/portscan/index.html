<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Pierre Averous "><meta name=description content="This experiment is about running a port scan of the client accessing this page.
How is this done you may ask ? Well I did not invent it, so kudos to Avi Lumelsky who wrote this brilliant article : Browsers — A Localhost Gateway: Client Port Scanning Using WebAssembly And Go.
The global principle is to have the browser make HTTP requests locally, on every port that you want to scan."><meta name=keywords content><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://pivrous.fr/experiments/portscan/><title>Portscan :: Pierre Averous — Site Reliability Engineer @Padok</title><link rel=stylesheet href=/main.b78c3be9451dc4ca61ca377f3dc2cf2e6345a44c2bae46216a322ef366daa399.css integrity="sha256-t4w76UUdxMphyjd/PcLPLmNFpEwrrkYhajIu82bao5k="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Portscan"><meta itemprop=description content="This experiment is about running a port scan of the client accessing this page.
How is this done you may ask ? Well I did not invent it, so kudos to Avi Lumelsky who wrote this brilliant article : Browsers — A Localhost Gateway: Client Port Scanning Using WebAssembly And Go.
The global principle is to have the browser make HTTP requests locally, on every port that you want to scan."><meta itemprop=datePublished content="2022-01-02T16:07:11+01:00"><meta itemprop=dateModified content="2022-01-02T16:07:11+01:00"><meta itemprop=wordCount content="228"><meta itemprop=image content="https://pivrous.fr"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pivrous.fr"><meta name=twitter:title content="Portscan"><meta name=twitter:description content="This experiment is about running a port scan of the client accessing this page.
How is this done you may ask ? Well I did not invent it, so kudos to Avi Lumelsky who wrote this brilliant article : Browsers — A Localhost Gateway: Client Port Scanning Using WebAssembly And Go.
The global principle is to have the browser make HTTP requests locally, on every port that you want to scan."><meta property="og:title" content="Portscan"><meta property="og:description" content="This experiment is about running a port scan of the client accessing this page.
How is this done you may ask ? Well I did not invent it, so kudos to Avi Lumelsky who wrote this brilliant article : Browsers — A Localhost Gateway: Client Port Scanning Using WebAssembly And Go.
The global principle is to have the browser make HTTP requests locally, on every port that you want to scan."><meta property="og:type" content="article"><meta property="og:url" content="https://pivrous.fr/experiments/portscan/"><meta property="og:image" content="https://pivrous.fr"><meta property="article:section" content="experiments"><meta property="article:published_time" content="2022-01-02T16:07:11+01:00"><meta property="article:modified_time" content="2022-01-02T16:07:11+01:00"><meta property="article:published_time" content="2022-01-02 16:07:11 +0100 +0100"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ curl pivrous.fr</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/experiments>Experiments</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://pivrous.fr/experiments/portscan/>Portscan</a></h2><div class=post-content><p>This experiment is about running a port scan of the client accessing this page.</p><p>How is this done you may ask ? Well I did not invent it, so kudos to <a href=https://avi-lumelsky.medium.com/>Avi Lumelsky</a> who wrote this brilliant article : <a href=https://infosecwriteups.com/identify-website-users-by-client-port-scanning-using-webassembly-and-go-e9798b4aa05c>Browsers — A Localhost Gateway: Client Port Scanning Using WebAssembly And Go</a>.</p><p>The global principle is to have the browser make HTTP requests locally, on every port that you want to scan. This is usually blocked by all modern browsers, but there seems to be a flaw when the requests are made through webassembly.</p><p>Analysing the response you get for each request, you can determine whether the port is open or closed !</p><blockquote><p>Note : it appears in the latest <a href=https://brave.com/>Brave Browser</a> release, these requests are recognized as potential trackers, and are therefore blocked. A great proof of concept that blocking site trackers not only increases your privacy, but your security as well.</p></blockquote><p>This is quite an interesting little project for one to build, that I totally recommend. It takes some fiddling with Golang and Javascript, and integrating it into a website with Webassembly is not as straightforward as one may think.</p><p>While reading this, your device actually got scanned ! You want to see the results ? Just wait a couple seconds for them to appear just below right here, once the scan is completed.</p><script src=/golang/wasm_exec.js></script>
<script>const sleep=e=>new Promise(t=>setTimeout(t,e));var show=function(e){e.style.display="block"},hide=function(e){e.style.display="none"}</script><script>const runPortScan=()=>{const e=new Go;WebAssembly.instantiateStreaming(fetch("/portscan/main.wasm"),e.importObject).then(t=>{e.run(t.instance)})}</script><script>const pollForResult=async()=>{let e=document.getElementById("scanResults"),t=document.getElementById("scanResultsText");for(hide(e);window.portsMapping===void 0;)await sleep(1e3);if(console.log("Finished scanning !"),openPorts=Object.fromEntries(Object.entries(window.portsMapping).filter(([e,t])=>t==!0)),t.innerHTML=`Scanned ${Object.keys(window.portsMapping).length} ports. Found the following open ports :`,Object.keys(openPorts).forEach(t=>{let n=document.createElement("li");n.appendChild(document.createTextNode(t)),e.appendChild(n)}),Object.keys(openPorts).length==0){let t=document.createElement("li");t.appendChild(document.createTextNode("No open port was found !")),e.appendChild(t)}show(e)}</script><div id=scanResultsText>Scan in progress...</div><ul id=scanResults></ul><script>scanner=new Promise(runPortScan),poller=new Promise(pollForResult),Promise.all([scanner,poller])</script></div></article><hr><div class=post-info></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2023</span>
<span><a href=https://pivrous.fr>Pierre Averous</a></span>
<span><a href=https://pivrous.fr/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div></footer></div><script type=text/javascript src=/bundle.min.205d491810c28f95aa953fae884e1c27abe13fdf93ec63b882d0036b248d4a6282eb2d134e4e7225c6ad6e86db87b08488a361ca4a7383d01fcff43f3d57b9c3.js integrity="sha512-IF1JGBDCj5WqlT+uiE4cJ6vhP9+T7GO4gtADaySNSmKC6y0TTk5yJcatbobbh7CEiKNhykpzg9Afz/Q/PVe5ww=="></script></body></html>